!function(){function a(a,b){this.x=a,this.y=b}var b=function(){function b(b){this.element=b,this.moveSpeed=3.5,this.size=new a(b.width(),b.height()),this.initialSpeed=this.moveSpeed,this.initialSize=new a(b.width(),b.height()),this.moveUp=!1,this.moveDown=!1,this.moveLeft=!1,this.moveRight=!1}return b.prototype.newGame=function(){this.moveSpeed=this.initialSpeed,this.size=new a(this.initialSize.x,this.initialSize.y),this.element.height(this.size.y)},b.prototype.update=function(a){this.moveUp&&this.doMoveUp(a),this.moveDown&&this.doMoveDown(a),this.moveLeft,this.moveRight},b.prototype.doMoveUp=function(a){if(this.element.position().top>0){var b=this.element.position();b.top-=this.moveSpeed*a,this.element.css({left:b.left,top:b.top})}},b.prototype.doMoveDown=function(a){if(this.element.position().top+this.size.y<this.element.parent().height()){var b=this.element.position();b.top+=this.moveSpeed*a,this.element.css({left:b.left,top:b.top})}},b.prototype.grow=function(a){this.size.y+=a,this.element.height(this.size.y)},b.prototype.shrink=function(a){this.size.y-=a,this.element.height(this.size.y)},b}(),c=function(){function a(a){this.id=a,this.score=0,this.paddle=new b($("#pad"+a))}return a.prototype.init=function(){this.initControls()},a.prototype.update=function(a){this.paddle.update(a)},a.prototype.newGame=function(){this.score=0,this.paddle.newGame()},a.prototype.initControls=function(){var a=this;switch(a.id){case 0:document.addEventListener("keydown",function(b){switch(b.keyCode){case 87:a.paddle.moveUp=!0;break;case 65:a.paddle.moveLeft=!0;break;case 83:a.paddle.moveDown=!0;break;case 68:a.paddle.moveRight=!0}},!1),document.addEventListener("keyup",function(b){switch(b.keyCode){case 87:a.paddle.moveUp=!1;break;case 65:a.paddle.moveLeft=!1;break;case 83:a.paddle.moveDown=!1;break;case 68:a.paddle.moveRight=!1}},!1);break;case 1:document.addEventListener("keydown",function(b){switch(b.keyCode){case 38:a.paddle.moveUp=!0;break;case 37:a.paddle.moveLeft=!0;break;case 40:a.paddle.moveDown=!0;break;case 39:a.paddle.moveRight=!0}},!1),document.addEventListener("keyup",function(b){switch(b.keyCode){case 38:a.paddle.moveUp=!1;break;case 37:a.paddle.moveLeft=!1;break;case 40:a.paddle.moveDown=!1;break;case 39:a.paddle.moveRight=!1}},!1)}},a.prototype.addScore=function(){this.score++,this.paddle.shrink(4),this.paddle.moveSpeed+=.5},a}(),d=function(){function b(b){this.element=b,this.pos=new a(this.element.position().left,this.element.position().top),this.initialPos=this.pos,this.velocity=new a(1,1),this.size=new a(b.width(),b.height()),this.hit=$()}return b.prototype.init=function(){},b.prototype.update=function(a){this.move(a)},b.prototype.reset=function(b,c){this.pos=this.initialPos,this.element.css({left:this.pos.x,top:this.pos.y}),this.hit=$(),this.velocity=new a(2*b,1)},b.prototype.move=function(b){var c=this.element.position();c.left+=this.velocity.x*b,c.top+=this.velocity.y*b,this.element.css({left:c.left,top:c.top}),this.pos=new a(c.left,c.top)},b.prototype.checkCollision=function(b){for(var c=0;c<b.length;c++){var d={};if(d.size=new a(b[c].width(),b[c].height()),d.pos=new a(b[c].position().left,b[c].position().top),this.pos.y+this.size.y>d.pos.y&&this.pos.y<d.pos.y+d.size.y&&this.pos.x+this.size.x>d.pos.x&&this.pos.x<d.pos.x+d.size.x){this.hit=b[c],b[c].hasClass("wall")?this.velocity.y=-this.velocity.y:b[c].hasClass("paddle")&&(this.velocity.x=-this.velocity.x);break}this.hit=$()}},b}(),e=function(){function e(){this.p0=new c(0),this.p1=new c(1),this.ball=new d($(".ball")),this.score0=$("#score0"),this.score1=$("#score1"),this.collidables=[],this.collidables.push($("#end-left")),this.collidables.push($("#end-right")),this.collidables.push(this.p0.paddle.element),this.collidables.push(this.p1.paddle.element),this.collidables.push($("#wall-top")),this.collidables.push($("#wall-bottom")),b.spin=1.5,b.time=0}var b={};return e.prototype.init=function(){this.initClickHandlers(),$("#game-over").css("display","none"),this.p0.init(),this.p1.init()},e.prototype.initClickHandlers=function(){var a=this;$("#start-btn").on("click",function(){a.run(),$(this).css("display","none")}),$("#game-over").on("click",function(){a.newGame(),$(this).css("display","none")})},e.prototype.run=function(){function a(){var c=(new Date).getTime(),d=c-(b.time||c);d*=.1,b.time=c,self.update(d),self.render(d),requestAnimationFrame(a)}self=this,requestAnimationFrame(a)},e.prototype.update=function(a){this.p0.update(a),this.p1.update(a),this.ball.update(a),this.collisionCheck(),this.winCheck()},e.prototype.render=function(a){this.p0.score<10&&this.score0.html("0"+this.p0.score),this.p1.score<10&&this.score1.html("0"+this.p1.score)},e.prototype.winCheck=function(){this.p0.score>=10&&this.endGame(0),this.p1.score>=10&&this.endGame(1)},e.prototype.collisionCheck=function(){this.ball.checkCollision(this.collidables),this.ball.hit.hasClass("endzone")?this.ball.hit.is("#end-right")?(this.p0.addScore(),this.ball.reset(1,this.ball.velocity.y)):this.ball.hit.is("#end-left")&&(this.p1.addScore(),this.ball.reset(-1,this.ball.velocity.y)):this.ball.hit.hasClass("paddle")&&(this.ball.hit.is("#pad0")?this.p0.paddle.moveUp?this.ball.velocity.y-=b.spin:this.p0.paddle.moveDown&&(this.ball.velocity.y+=b.spin):this.ball.hit.is("#pad1")&&(this.p1.paddle.moveUp?this.ball.velocity.y-=b.spin:this.p0.paddle.moveDown&&(this.ball.velocity.y+=b.spin)),this.ball.velocity.x*=1.25)},e.prototype.newGame=function(){this.p0.newGame(),this.p1.newGame(),this.ball.velocity=new a(1,1)},e.prototype.endGame=function(a){this.ball.velocity.x=0,this.ball.velocity.y=0,$("#game-over").html("Player "+(a+1)+" wins! </br> Play Again?"),$("#game-over").css("display","block")},new e}();$(document).ready(function(){e.init()})}();